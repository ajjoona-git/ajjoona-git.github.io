---
title: "[ëª¨ì•„í†¤] AWS HTTPS ë°°í¬ ê°€ì´ë“œ (CloudFront + Nginx + Certbot)"
date: 2026-01-02 09:00:00 +0900
categories: [Projects, ëª¨ì•„í†¤]
tags: [AWS, Https, CloudFront, Nginx, Certbot, SSL, Deployment, Nip.io, Network]
toc: true 
comments: true
image: /assets/img/posts/2026-01-02-moathon-aws-https-deploy/6.png
description: "ë„ë©”ì¸ êµ¬ë§¤ ì—†ì´ ë¬´ë£Œë¡œ HTTPS í™˜ê²½ì„ êµ¬ì¶•í•©ë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œëŠ” CloudFront CDNì„ í†µí•´, ë°±ì—”ë“œëŠ” nip.ioì™€ Certbot(Let's Encrypt)ì„ í†µí•´ SSL ì¸ì¦ì„œë¥¼ ì ìš©í•˜ê³  ë³´ì•ˆ ê·¸ë£¹ ë° CORS ì„¤ì •ì„ ìµœì í™”í•˜ëŠ” ê³¼ì •ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤."
---

{% linkpreview "https://ajjoona-git.github.io/posts/moathon-aws-deployment" %}

ì§€ë‚œ í¬ìŠ¤íŠ¸ì—ì„œ EC2ì™€ S3ë¥¼ ì´ìš©í•´ ë°°í¬ì— ì„±ê³µí–ˆì§€ë§Œ, ì£¼ì†Œì°½ì˜ 'ì£¼ì˜ ìš”í•¨(Not Secure)' ë¬¸êµ¬ê°€ ëˆˆì— ë°Ÿí˜”ë‹¤.
ì´ë²ˆì—ëŠ” **CloudFront**ì™€ **Nginx + Certbot** ì¡°í•©ì„ í†µí•´ í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ëª¨ë‘ì— **HTTPS(ë³´ì•ˆ ì ‘ì†)**ë¥¼ ì ìš©í•˜ì—¬ ì•„í‚¤í…ì²˜ë¥¼ ì™„ì„±í•´ ë³¸ë‹¤.

---

## ì•„í‚¤í…ì²˜ êµ¬ì¡°

**CloudFront**ê°€ ì•ë‹¨ì—ì„œ í™”ë©´ì„ ì•ˆì „í•˜ê²Œ(HTTPS) ë³´ì—¬ì£¼ê³ , ì‚¬ìš©ìê°€ APIë¥¼ ìš”ì²­í•˜ë©´ **Nginx**ê°€ ì´ë¥¼ ë°›ì•„ ë‚´ë¶€ì˜ Djangoì—ê²Œ ì „ë‹¬í•˜ëŠ” êµ¬ì¡°ë‹¤.

![ì•„í‚¤í…ì²˜](/assets/img/posts/2026-01-02-moathon-aws-https-deploy/6.png)
*ì•„í‚¤í…ì²˜*

### í”„ë¡ íŠ¸ì—”ë“œ ì˜ì—­ (í™”ë©´ ë³´ì—¬ì£¼ê¸°)

ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— `https://d3xxxx.cloudfront.net`ì„ ì…ë ¥í–ˆì„ ë•Œì˜ íë¦„ì´ë‹¤.

- **CloudFront (AWS CDN):**
    - **ì—­í• :** ì‚¬ìš©ìì™€ ê°€ì¥ ê°€ê¹Œìš´ ê³³ì—ì„œ ì›¹ì‚¬ì´íŠ¸ íŒŒì¼(`html`, `css`, `js`)ì„ ë¹ ë¥´ê²Œ ì „ë‹¬í•œë‹¤.
    - **HTTPS ì—­í• :** S3ëŠ” HTTPSë¥¼ ëª» ì“°ì§€ë§Œ, CloudFrontê°€ ëŒ€ì‹  HTTPS ì•”í˜¸í™”ë¥¼ ì²˜ë¦¬í•´ì„œ ì‚¬ìš©ìì—ê²Œ ì•ˆì „í•œ ìë¬¼ì‡ (ğŸ”’)ë¥¼ ë³´ì—¬ì¤€ë‹¤.
    - **ìºì‹±:** í•œ ë²ˆ ê°€ì ¸ì˜¨ íŒŒì¼ì€ ê¸°ì–µí•´ ë’€ë‹¤ê°€, ë‹¤ìŒ ìš”ì²­ ë•Œ S3ê¹Œì§€ ì•ˆ ê°€ê³  ë°”ë¡œ ì¤€ë‹¤.
- **S3 (Simple Storage Service):**
    - **ì—­í• :** ìš°ë¦¬ê°€ ë§Œë“  Vue.js ë¹Œë“œ ê²°ê³¼ë¬¼(`dist` í´ë” ë‚´ìš©)ì´ ì €ì¥ëœ ì›ë³¸ ì°½ê³ .
    - **íŠ¹ì§•:** ì •ì  ì›¹ ì‚¬ì´íŠ¸ í˜¸ìŠ¤íŒ… ê¸°ëŠ¥ì„ ì¼œì„œ ì›¹ ì„œë²„ì²˜ëŸ¼ ë™ì‘í•˜ì§€ë§Œ, ë³´ì•ˆ ê¸°ëŠ¥(HTTPS)ì´ ì•½í•´ì„œ CloudFront ë’¤ì— ìˆ¨ê²¨ë‘ì—ˆë‹¤.

### ë°±ì—”ë“œ ì˜ì—­ (ë°ì´í„° ì²˜ë¦¬í•˜ê¸°)

ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ ë²„íŠ¼ì„ ëˆ„ë¥´ê±°ë‚˜ ìƒí’ˆ ëª©ë¡ì„ ì¡°íšŒí•  ë•Œì˜ íë¦„ì´ë‹¤.

- **nip.io (Magic Domain):**
    - **ì—­í• :** `54.180.xx.xx`ë¼ëŠ” ìˆ«ì ì£¼ì†Œ(IP)ëŠ” SSL ì¸ì¦ì„œë¥¼ ëª» ë°›ëŠ”ë‹¤. `nip.io`ëŠ” ì´ IPë¥¼ ë§ˆì¹˜ `domain.com` ê°™ì€ ë„ë©”ì¸ ì´ë¦„ì²˜ëŸ¼ ë³´ì´ê²Œ í•´ì¤€ë‹¤. ë•ë¶„ì— ë¬´ë£Œë¡œ HTTPS ì¸ì¦ì„œë¥¼ ë°›ì„ ìˆ˜ ìˆì—ˆë‹¤.
- **Nginx (Web Server):**
    - **ì—­í• :** EC2 ì„œë²„ì˜ ë¬¸ì§€ê¸°.
    - **HTTPS ì²˜ë¦¬:** ì‚¬ìš©ìì˜ ì•”í˜¸í™”ëœ ìš”ì²­ì„ ë°›ì•„ì„œ í•´ë…(SSL Termination)í•œ ë’¤, ë‚´ë¶€ì˜ Gunicornì—ê²Œ ë„˜ê²¨ì¤€ë‹¤.
    - **ì •ì  íŒŒì¼ ì²˜ë¦¬:** Djangoê°€ ì²˜ë¦¬í•  í•„ìš” ì—†ëŠ” ë‹¨ìˆœ íŒŒì¼(CSS, ì´ë¯¸ì§€ ë“±)ì€ ì§ì ‘ ë¹ ë¥´ê²Œ ì¤€ë‹¤.
- **Certbot (Let's Encrypt):**
    - **ì—­í• :** "ì´ ì„œë²„ëŠ” ì•ˆì „í•œ ì„œë²„ì…ë‹ˆë‹¤"ë¼ê³  ì¦ëª…í•˜ëŠ” **SSL ì¸ì¦ì„œ**ë¥¼ ë¬´ë£Œë¡œ ë°œê¸‰í•´ì£¼ê³ , Nginx ì„¤ì •ì„ ìë™ìœ¼ë¡œ ê³ ì³ì£¼ëŠ” ë„êµ¬.
- **Gunicorn (WSGI Server):**
    - **ì—­í• :** ì›¹ ì„œë²„ì¸ Nginxì™€ íŒŒì´ì¬ í”„ë¡œê·¸ë¨ì¸ Django ì‚¬ì´ì—ì„œ ë§ì„ ì „ë‹¬í•´ì¤€ë‹¤. NginxëŠ” íŒŒì´ì¬ ì½”ë“œë¥¼ ì´í•´ ëª» í•˜ê¸° ë•Œë¬¸.
- **Django (Web Framework):**
    - **ì—­í• :** ì‹¤ì œ ë¡œì§ì„ ì²˜ë¦¬í•œë‹¤. DBì—ì„œ ë°ì´í„°ë¥¼ êº¼ë‚´ê³ , ê³„ì‚°í•˜ê³ , JSON í˜•íƒœë¡œ ê°€ê³µí•´ì„œ í”„ë¡ íŠ¸ì—”ë“œì— ì‘ë‹µì„ ì¤€ë‹¤.
    - **Settings:** `ALLOWED_HOSTS`(ìš°ë¦¬ ì§‘ ì£¼ì†Œ í—ˆìš©), `CORS`(í”„ë¡ íŠ¸ì—”ë“œ ì¹œêµ¬ í—ˆìš©) ì„¤ì •ì„ í†µí•´ ë³´ì•ˆ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•œë‹¤.
- **AWS Security Group (Firewall):**
    - **ì—­í• :** AWS í´ë¼ìš°ë“œ ì°¨ì›ì—ì„œ í¬íŠ¸(ë¬¸)ë¥¼ ì—´ê³  ë‹«ëŠ”ë‹¤.
    - **HTTPS(443):** ì•”í˜¸í™”ëœ í¸ì§€ê°€ ë“¤ì–´ì˜¤ëŠ” ì „ìš© ì¶œì…êµ¬. ì´ê±¸ ì•ˆ ì—´ì–´ì£¼ë©´ Nginxê°€ ì•„ë¬´ë¦¬ ê¸°ë‹¤ë ¤ë„ ìš”ì²­ì´ ë„ì°©í•˜ì§€ ì•ŠëŠ”ë‹¤.

---

## 1. ë°±ì—”ë“œ HTTPS ì ìš© (Nginx + Certbot)

ë³´í†µ SSL ì¸ì¦ì„œë¥¼ ë°›ìœ¼ë ¤ë©´ ìœ ë£Œ ë„ë©”ì¸ì´ í•„ìš”í•˜ë‹¤. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” **`nip.io` (ë§¤ì§ ë„ë©”ì¸ ì„œë¹„ìŠ¤)**ë¥¼ í™œìš©í•´ IP ì£¼ì†Œë¥¼ ë„ë©”ì¸ì²˜ëŸ¼ ì‚¬ìš©í•˜ì—¬ ë¬´ë£Œ ì¸ì¦ì„œ(Let's Encrypt)ë¥¼ ë°œê¸‰ë°›ì„ ê²ƒì´ë‹¤.

### 1-1. Nginx ì„¤ì • ìˆ˜ì • (`nip.io` ì ìš©)

EC2 ì„œë²„ì˜ Nginx ì„¤ì •ì—ì„œ server_nameì„ IP ì£¼ì†Œ ê¸°ë°˜ì˜ ë„ë©”ì¸ í˜•ì‹ìœ¼ë¡œ ë³€ê²½í•œë‹¤.

```bash
# /etc/nginx/sites-available/moathon

server {
    listen 80;
    # IPê°€ 54.180.xx.xx ë¼ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±
    server_name 54.180.xx.xx.nip.io; 

    # ... ê¸°ì¡´ ì„¤ì • ...
}
```


### 1-2. Certbot ì„¤ì¹˜ ë° ì¸ì¦ì„œ ë°œê¸‰

ë¬´ë£Œ ì¸ì¦ì„œ ë°œê¸‰ ë„êµ¬ì¸ Certbotì„ ì„¤ì¹˜í•˜ê³  ì‹¤í–‰í•œë‹¤. Nginx í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ë©´ ì„¤ì • íŒŒì¼ê¹Œì§€ ìë™ìœ¼ë¡œ ìˆ˜ì •í•´ ì¤€ë‹¤.

```bash
# 1. Certbot ì„¤ì¹˜
sudo snap install --classic certbot
sudo ln -s /snap/bin/certbot /usr/bin/certbot

# 2. ì¸ì¦ì„œ ë°œê¸‰ (ì´ë©”ì¼ ì…ë ¥ -> ì•½ê´€ ë™ì˜ Y -> ë§ˆì¼€íŒ… N)
sudo certbot --nginx
```

ëª…ë ¹ì–´ê°€ ì™„ë£Œë˜ë©´ ë°±ì—”ë“œëŠ” ì´ì œ `https://54.180.xx.xx.nip.io` ì£¼ì†Œë¥¼ ê°–ê²Œ ëœë‹¤.

![Certbot ì¸ì¦ì„œ ë°œê¸‰](/assets/img/posts/2026-01-02-moathon-aws-https-deploy/5.png)
*Certbot ì¸ì¦ì„œ ë°œê¸‰*

### 1-3. Django ì„¤ì • ì—…ë°ì´íŠ¸

ë„ë©”ì¸ì´ ë³€ê²½ë˜ì—ˆê³  í”„ë¡œí† ì½œì´ HTTPSë¡œ ë°”ë€Œì—ˆìœ¼ë¯€ë¡œ Djangoì˜ ë³´ì•ˆ ì„¤ì •ì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•œë‹¤.

```python
# settings.py

ALLOWED_HOSTS = [
    '52.180.xx.xx', 
    '52.180.xx.xx.nip.io' # [ì¶”ê°€] nip.io ë„ë©”ì¸ í—ˆìš©
]

# [ì¶”ê°€] HTTPS ìš”ì²­ì˜ CSRF ê²€ì¦ì„ ìœ„í•œ ì‹ ë¢° ë„ë©”ì¸ ì„¤ì •
CSRF_TRUSTED_ORIGINS = ['https://52.180.xx.xx.nip.io']
```


## 2. í”„ë¡ íŠ¸ì—”ë“œ HTTPS ì ìš© (CloudFront)

S3 ì •ì  ì›¹ í˜¸ìŠ¤íŒ…ì€ ê¸°ë³¸ì ìœ¼ë¡œ HTTPë§Œ ì§€ì›í•œë‹¤. AWSì˜ CDN ì„œë¹„ìŠ¤ì¸ CloudFrontë¥¼ ì•ë‹¨ì— ë‘ì–´ HTTPSë¥¼ ì²˜ë¦¬í•˜ë„ë¡ êµ¬ì„±í•œë‹¤.

### 2-1. CloudFront ë°°í¬ ìƒì„±

1. **Origin domain:** S3ì˜ 'ì •ì  ì›¹ ì‚¬ì´íŠ¸ í˜¸ìŠ¤íŒ… ì—”ë“œí¬ì¸íŠ¸' URL ì…ë ¥.
2. **Viewer protocol policy: Redirect HTTP to HTTPS** ì„ íƒ (ë³´ì•ˆ ê°•ì œ).
    - (ì˜ˆ: `http://moathon-client-dist.s3-website.ap-northeast-2.amazonaws.com`)
3. ë‚˜ë¨¸ì§€ ê¸°ë³¸ê°’ìœ¼ë¡œ ìƒì„±.

![ë°°í¬ ìƒì„±](/assets/img/posts/2026-01-02-moathon-aws-https-deploy/4.png)
*ë°°í¬ ìƒì„±*

### 2-2. ë°°í¬ ì™„ë£Œ

ìƒì„±ì´ ì™„ë£Œë˜ë©´ `d3xxxxxx.cloudfront.net `í˜•íƒœì˜ ë„ë©”ì¸ì´ ë°œê¸‰ëœë‹¤. ì´ì œ ì´ ì£¼ì†Œë¡œ ì ‘ì†í•˜ë©´ ì•ˆì „í•œ ìë¬¼ì‡  ì•„ì´ì½˜(ğŸ”’)ì„ ë³¼ ìˆ˜ ìˆë‹¤.

## 3. í”„ë¡ íŠ¸ì—”ë“œ & ë°±ì—”ë“œ ì—°ê²° (Integration)

ì–‘ìª½ ëª¨ë‘ HTTPSë¡œ ì „í™˜ë˜ì—ˆìœ¼ë¯€ë¡œ, ì„œë¡œë¥¼ ë°”ë¼ë³´ëŠ” ì£¼ì†Œë¥¼ ìˆ˜ì •í•˜ê³  ì¬ë°°í¬í•´ì•¼ í•œë‹¤.

### 3-1. í”„ë¡ íŠ¸ì—”ë“œ í™˜ê²½ ë³€ìˆ˜ ìˆ˜ì • (Local)

API ìš”ì²­ì„ ë³´ë‚´ëŠ” ë°±ì—”ë“œ ì£¼ì†Œë¥¼ httpsì™€ nip.ioê°€ í¬í•¨ëœ ì£¼ì†Œë¡œ ë³€ê²½í•œë‹¤.

```python
# .env.production
VITE_API_URL=https://52.180.xx.xx.nip.io
```

### 3-2. ë°±ì—”ë“œ CORS ì„¤ì • ìˆ˜ì • (EC2)

Djangoê°€ í—ˆìš©í•  í”„ë¡ íŠ¸ì—”ë“œ ë„ë©”ì¸(CloudFront ì£¼ì†Œ)ì„ ì¶”ê°€í•œë‹¤.

```python
# settings.py

CORS_ALLOWED_ORIGINS = [
    # ... ê¸°ì¡´ ì£¼ì†Œë“¤ ...
    'https://d1xxxxxx.cloudfront.net', # [ì¶”ê°€] CloudFront ë„ë©”ì¸
]

CSRF_TRUSTED_ORIGINS = [
    'https://52.180.xx.xx.nip.io', # ë°±ì—”ë“œ ì£¼ì†Œ
    'https://d1xxxxxx.cloudfront.net', # í”„ë¡ íŠ¸ì—”ë“œ ì£¼ì†Œ
]
```
ì„¤ì • í›„ `sudo systemctl restart gunicorn`ìœ¼ë¡œ ì„œë²„ë¥¼ ì¬ì‹œì‘í•œë‹¤.

### 3-3. ì¬ë¹Œë“œ ë° ë°°í¬

í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œë¥¼ ë‹¤ì‹œ ë¹Œë“œ(`npm run build`)í•˜ê³ , S3 ë²„í‚·ì˜ ë‚´ìš©ì„ ë®ì–´ì”Œìš´ë‹¤.


## 4. ìµœì¢… ë³´ì•ˆ ë° ìºì‹œ ì„¤ì •

### 4-1. AWS ë³´ì•ˆ ê·¸ë£¹ (Security Group) ì„¤ì •

EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ë°©í™”ë²½ ì„¤ì •ì—ì„œ **HTTPS(443) í¬íŠ¸**ë¥¼ ì—´ì–´ì¤˜ì•¼ í•œë‹¤. ì´ë¥¼ ë†“ì¹˜ë©´ Nginxê¹Œì§€ ìš”ì²­ì´ ë„ë‹¬í•˜ì§€ ëª»í•œë‹¤.

- **ìœ í˜•:** HTTPS (443)

- **ì†ŒìŠ¤:** Anywhere-IPv4 (0.0.0.0/0)

![ì¸ë°”ìš´ë“œ ê·œì¹™ í¸ì§‘](/assets/img/posts/2026-01-02-moathon-aws-https-deploy/3.png)
*ì¸ë°”ìš´ë“œ ê·œì¹™ í¸ì§‘*

### 4-2. CloudFront ìºì‹œ ë¬´íš¨í™” (Invalidation)

S3ì— ìƒˆ íŒŒì¼ì„ ì˜¬ë ¸ë”ë¼ë„ CloudFrontëŠ” ìºì‹œëœ êµ¬ë²„ì „ íŒŒì¼ì„ ê³„ì† ë³´ì—¬ì¤„ ìˆ˜ ìˆë‹¤. ë³€ê²½ ì‚¬í•­ì„ ì¦‰ì‹œ ë°˜ì˜í•˜ê¸° ìœ„í•´ ìºì‹œë¥¼ ë‚ ë ¤ì¤€ë‹¤.

- **ê²½ë¡œ:** CloudFront ì½˜ì†” > ë°°í¬ ì„ íƒ > ë¬´íš¨í™” íƒ­

- **ê°ì²´ ê²½ë¡œ:** `/*` (ëª¨ë“  íŒŒì¼ ë¬´íš¨í™”)

![ë¬´íš¨í™” ìƒì„±](/assets/img/posts/2026-01-02-moathon-aws-https-deploy/2.png)
*ë¬´íš¨í™” ìƒì„±*


## ìµœì¢… ì ‘ì†

ì´ì œ ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— CloudFront ë„ë©”ì¸(`https://...`)ì„ ì…ë ¥í•˜ë©´ **ìë¬¼ì‡  ì•„ì´ì½˜**ê³¼ í•¨ê»˜ ì•ˆì „í•˜ê²Œ ì ‘ì†ëœë‹¤. ê°œë°œì ë„êµ¬ì˜ Network íƒ­ì„ í™•ì¸í•´ ë³´ë©´, ë°±ì—”ë“œ API ìš”ì²­ ë˜í•œ HTTPSë¡œ ì•”í˜¸í™”ë˜ì–´ ì „ì†¡ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

*>> ëª¨ì•„í†¤ ë°”ë¡œê°€ê¸°*
{% linkpreview "https://d314hr75zv7jjv.cloudfront.net/" %}

![https ì ‘ì† í™•ì¸](/assets/img/posts/2026-01-02-moathon-aws-https-deploy/1.png)
*https ì ‘ì† í™•ì¸*

ì´ë¡œì¨ **ë³´ì•ˆì„±(Security)**ê³¼ **ì„±ëŠ¥(CDN)**ì„ ëª¨ë‘ ì¡ì€ ë°°í¬ ì•„í‚¤í…ì²˜ê°€ ì™„ì„±ë˜ì—ˆë‹¤.

---

### ë ˆí¼ëŸ°ìŠ¤

[[Deploy] nip.io, Nginx, certbotì„ ì´ìš©í•œ https ì ìš©](https://innovation123.tistory.com/241)